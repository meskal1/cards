"use strict";(self.webpackChunkcards=self.webpackChunkcards||[]).push([[909],{8893:function(e,n,a){a.d(n,{F:function(){return m}});var t=a(1413),s=a(885),r=a(5987),i=a(2791),d=a(4346),o="ClickableImage_smallImg__TzOOd",c="ClickableImage_fullSizedImg__y4QsX",l=a(184),u=["className"],m=function(e){var n=e.className,a=(0,r.Z)(e,u),m=(0,i.useState)(!1),_=(0,s.Z)(m,2),C=_[0],f=_[1],p=(0,i.useState)(!1),g=(0,s.Z)(p,2),h=g[0],x=g[1],v=n?"".concat(n," ").concat(o):o;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("img",(0,t.Z)({className:v,onClick:function(){return f(!0)},onError:function(){return x(!0)}},a)),!h&&(0,l.jsx)(d.I,{isOpened:C,onClose:function(){return f(!1)},children:(0,l.jsx)("img",{className:c,src:a.src})})]})}},5909:function(e,n,a){a.r(n),a.d(n,{Cards:function(){return he}});var t=a(1413),s=a(885),r=a(2791),i=a(1835),d=a.n(i),o=a(7689),c=a(6977),l=a(8893),u=a(3745),m=a(2142),_=a(2599),C=a(6329),f=a(3294),p=a(9911),g=a(9565),h=a(1015),x=a(395),v="Cards_cardsContainer__aYsFI",j="Cards_cards__controlBlock__qTx-z",b="Cards_imgContainer__b9F-k",q="Cards_img__cGe1w",k=a(172),w=a(1607),N=a(7358),T=a(824),I="CardsTable_tableCards__2IL8g",O="CardsTable_cards__emptyBlock__Zf3yi",y="CardsTable_cards__emptyTitle__2rNiu",D="CardsTable_addButton__qsLXM",A=a(8447),Z=a(7892),B=a.n(Z),E=a(4958),F=a(4165),P=a(5861),S=a(5705),M=a(5680),R=a(8142),U=a(8726),z=a(4472),L=a(6732),Q={selectContainer:"AddEditCard_selectContainer__6UPPR",addImageBlock:"AddEditCard_addImageBlock__cVyCq",dargOver:"AddEditCard_dargOver__AumPn",addImageBlockTitle:"AddEditCard_addImageBlockTitle__4Hfe0",hidden:"AddEditCard_hidden__SsOwQ",imageContainer:"AddEditCard_imageContainer__+hm0Q",image:"AddEditCard_image__APHyn"},V=a(184),G=[{id:"text",label:"Text"},{id:"picture",label:"Picture"}],Y=(0,r.memo)((function(e){var n=e.isOpened,a=e.onClose,i=e.cardsPack_id,o=void 0===i?"":i,c=e.cardsData,l=(0,p.T)(),u=d()((null===c||void 0===c?void 0:c.questionImg)||"",{mimeRequired:!0}),m=u?G[1].id:G[0].id,_=(0,r.useState)(m),C=(0,s.Z)(_,2),f=C[0],g=C[1],h=(0,r.useState)(u?null===c||void 0===c?void 0:c.questionImg:""),x=(0,s.Z)(h,2),v=x[0],j=x[1],b=(0,r.useState)(null),q=(0,s.Z)(b,2),w=q[0],N=q[1],T=(0,r.useState)(!1),I=(0,s.Z)(T,2),O=I[0],y=I[1],D="text"!==f,A=(0,r.useRef)(),Z={size:(null===w||void 0===w?void 0:w.size)||0,type:(null===w||void 0===w?void 0:w.type)||"",selectedItem:D,isImageExist:!!v},B={questionImg:"",question:(null===c||void 0===c?void 0:c.question)||"",answer:(null===c||void 0===c?void 0:c.answer)||""},Y=(0,S.TA)({initialValues:B,validationSchema:L.GB,validate:function(){return(0,L.ap)(Z)},onSubmit:function(e){var n=D?"":e.question,t=w||v?v:" ",s=e.answer!==B.answer,r=e.question!==B.question;c&&(w||s||r)&&l((0,k.NB)({answer:(0,E.v)(e.answer),question:(0,E.v)(e.question),id:(null===c||void 0===c?void 0:c.id)||"",questionImg:t})),c||l((0,k.zJ)({answer:(0,E.v)(e.answer),question:(0,E.v)(n),questionImg:v,cardsPack_id:o})),a()}}),X=function(){var e=(0,P.Z)((0,F.Z)().mark((function e(n){var a;return(0,F.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,"files"in n.target&&n.target.files?N(n.target.files[0]):"dataTransfer"in n&&N(n.dataTransfer.files[0]),e.next=5,(0,z.f)(n);case 5:a=e.sent,Y.setFieldValue("question"," "),Y.setTouched((0,t.Z)((0,t.Z)({},Y.touched),{},{questionImg:!0})),j(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log("Error File Upload: ",e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(n){return e.apply(this,arguments)}}(),H=function(e){"Enter"===e.key&&Y.handleSubmit()},J=(0,r.useCallback)((function(e){f!==e&&(g(e),Y.resetForm(),Y.setValues({questionImg:"",question:"",answer:""}),Y.setFieldError("questionImg",""),j(""),N(null))}),[f]);return(0,r.useEffect)((function(){D||setTimeout((function(){var e;return null===A||void 0===A||null===(e=A.current)||void 0===e?void 0:e.focus()}),50)}),[]),(0,V.jsxs)(U.N,{title:c?"Edit card":"Add new card",onOkButtonText:c?"Update":"Create",onOk:Y.handleSubmit,isOpened:n,onClose:a,children:[(0,V.jsxs)("div",{className:Q.selectContainer,children:[(0,V.jsx)("p",{className:Q.selectTitle,children:"Choose a question format"}),(0,V.jsx)(R.A,{positionOptions:"left",initValue:f,options:G,selectedOption:J})]}),(0,V.jsxs)("form",{onSubmit:Y.handleSubmit,children:["text"===f?(0,V.jsx)(M.t,(0,t.Z)({inputRef:A,label:"Question",autoComplete:"new-password",error:Y.touched.question&&!!Y.errors.question,helperText:Y.touched.question&&Y.errors.question,onKeyDown:H},Y.getFieldProps("question"))):(0,V.jsxs)("label",{className:"".concat(Q.addImageBlock," ").concat(O?Q.dargOver:""),onDragOver:function(e){e.preventDefault(),y(!0)},onDragLeave:function(){return y(!1)},onDrop:X,children:[(0,V.jsxs)("p",{className:Q.addImageBlockTitle,children:["Drag your image here or click to upload.",(0,V.jsx)("br",{}),"File size should be less than 100kb"]}),(0,V.jsx)(M.t,(0,t.Z)((0,t.Z)({type:"file",inputProps:{accept:".jpg,.jpeg,.gif,.png,.webp,.svg"},className:Q.hidden,error:Y.touched.questionImg&&!!Y.errors.questionImg,helperText:Y.touched.questionImg&&Y.errors.questionImg},Y.getFieldProps("questionImg")),{},{onChange:X})),!!v&&(0,V.jsx)("div",{className:Q.imageContainer,children:(0,V.jsx)("img",{src:v,alt:"cover",className:Q.image})})]}),(0,V.jsx)(M.t,(0,t.Z)({label:"Answer",autoComplete:"new-password",autoFocus:n,error:Y.touched.answer&&!!Y.errors.answer,helperText:Y.touched.answer&&Y.errors.answer,onKeyDown:H},Y.getFieldProps("answer")))]})]})})),X=a(4001),H=a(6479),J=function(e){var n=e.id,a=e.isOpened,t=e.onClose,s=(0,p.T)(),r=function(){s((0,k.AM)(n)),t()};return(0,H.P)(r),(0,V.jsx)(X.V,{title:"Delete card",primaryColor:"red",onOkButtonText:"Delete",onOk:r,isOpened:a,onClose:t,children:"Are you sure you want to delete current card? Confirm deletion"})},K="CardActionsMenu_menuContainer__78870",W="CardActionsMenu_menu__aneCs",$="CardActionsMenu_openMenuLeft__SOq5z",ee="CardActionsMenu_menuItem__5n86X",ne=a(6492),ae=a(5325),te=function(e){var n=e.parentRef,a=e.handleEdit,t=e.handleDelete,s=e.closeMenu,i=(0,r.useRef)();return(0,ae.t)(s,i,n),(0,ne.q)(s),(0,V.jsxs)("ul",{ref:i,className:W,onClick:s,children:[(0,V.jsx)("li",{className:ee,onMouseDown:a}),(0,V.jsx)("li",{className:ee,onMouseDown:t})]})},se=function(e){var n=e.cardID,a=e.answer,i=e.question,d=e.questionImg,o=(0,r.useState)(!1),c=(0,s.Z)(o,2),l=c[0],u=c[1],m=l?$:"",_={deleteOpened:!1,editOpened:!1},C=(0,r.useState)(_),f=(0,s.Z)(C,2),p=f[0],g=f[1],h=(0,r.useRef)(),x={id:n,answer:a,question:i,questionImg:d},v=function(){return u(!l)},j=function(){return g(_)};return(0,V.jsxs)(V.Fragment,{children:[p.editOpened&&(0,V.jsx)(Y,{isOpened:p.editOpened,onClose:j,cardsData:x}),p.deleteOpened&&(0,V.jsx)(J,{isOpened:p.deleteOpened,id:n,onClose:j}),(0,V.jsx)("div",{ref:h,className:"".concat(K," ").concat(m),onClick:v,children:l&&(0,V.jsx)(te,{parentRef:h,handleEdit:function(){return g((0,t.Z)((0,t.Z)({},p),{},{editOpened:!p.editOpened}))},handleDelete:function(){return g((0,t.Z)((0,t.Z)({},p),{},{deleteOpened:!p.deleteOpened}))},closeMenu:v})})]})},re="CardsTableBody_cardImageWrapper__8RZer",ie="CardsTableBody_cardName__Qe-Vb",de="CardsTableBody_cardNameAdaptive__u389k",oe="CardsTableBody_cardImage__wUpg8",ce="CardsTableBody_tableCards__body__AC4ub",le="CardsTableBody_tableCards__bodyRow__5LfMu",ue="CardsTableBody_tableCards__bodyCellContent__Jfoqc",me="CardsTableBody_tableCards__bodyCell__PDQUj",_e="CardsTableBody_tableCards__bodyCellTitle__5SgyV",Ce="CardsTableBody_rating__G2Emo",fe=function(e){var n=e.heads,a=e.isMine,t=(0,g.C)((function(e){return e.cards.tableData})),s=(0,x.DU)(),r=function(e){return e.stopPropagation()};return(0,V.jsx)("tbody",{className:ce,children:t.map((function(e){return(0,V.jsxs)("tr",{className:le,children:[n.map((function(n,a){var t=d()(e.questionImg,{mimeRequired:!0});return(0,V.jsx)("td",{className:me,scope:"row",onClick:function(){return n=e._id,a=e.cardsPack_id,void("loading"!==e.requestStatus&&s(f.m.LEARN+"/".concat(a),{state:{cardId:n}}));var n,a},children:(0,V.jsxs)("div",{className:ue,children:[(0,V.jsx)("div",{className:_e,children:0===a?"".concat(t?"":e[n.id]):n.label}),"question"===n.id&&t&&(0,V.jsx)("div",{className:re,onClick:r,children:(0,V.jsx)(l.F,{src:e.questionImg,alt:"deckCover",className:oe})}),"grade"===n.id?(0,V.jsx)(A.Z,{className:Ce,value:e[n.id],readOnly:!0}):(0,V.jsx)("p",{className:"".concat(de," ").concat("question"===n.id&&t?ie:""),children:"updated"===n.id?B()(e[n.id]).format("DD.MM.YYYY"):(0,E.v)(e[n.id]+"")})]})},n.id)})),(0,V.jsx)("td",{className:me,children:a&&(0,V.jsx)(se,{cardID:e._id,answer:e.answer,question:e.question,questionImg:e.questionImg})})]},e._id)}))})},pe=[{id:"question",label:"Question"},{id:"answer",label:"Answer"},{id:"grade",label:"Grade"},{id:"updated",label:"Last updated"}],ge=(0,r.memo)((function(e){var n=e.isMine,a=e.showButton,t=e.handleTitleButton,s=(0,g.C)((function(e){return e.cards.status})),r=(0,g.C)((function(e){return e.cards.cardsData.cardsTotalCount})),i=(0,g.C)((function(e){return e.cards.queryParams.pageCount}));return(0,V.jsx)(V.Fragment,{children:r?(0,V.jsxs)("table",{className:I,children:[(0,V.jsx)(T.E,{heads:pe,forCards:!0,withActions:n}),"loading"===s?(0,V.jsx)(N.U,{columnsCount:pe.length,rowsCount:i,withActions:n}):(0,V.jsx)(fe,{heads:pe,isMine:n})]}):(0,V.jsx)(V.Fragment,{children:"loading"===s?(0,V.jsx)(_.A,{}):(0,V.jsxs)("div",{className:O,children:[(0,V.jsxs)("h3",{className:y,children:["No cards found."," ",n&&!a?"Click add new card to fill this pack":""]}),n&&!a&&(0,V.jsx)(w.o,{className:D,onClick:t,children:(0,V.jsx)("p",{children:"Add new card"})})]})})})})),he=function(){var e=(0,o.UO)().id,n=(0,p.T)(),a=(0,h.v)(),i=(0,g.C)((function(e){return e.cards.cardsData.cardsTotalCount})),w=(0,g.C)(c.q),N=(0,g.C)((function(e){return e.cards.cardsData.packName})),T=(0,g.C)((function(e){return e.cards.cardsData.packDeckCover})),I=(0,g.C)((function(e){return e.cards.error})),O=(0,x.DU)(),y=(0,r.useState)(!1),D=(0,s.Z)(y,2),A=D[0],Z=D[1],B=d()(T,{mimeRequired:!0}),E=a.cardQuestion?1:0,F=(0,r.useRef)(i||E||0);i&&!F.current&&F.current++;var P=(0,r.useCallback)((function(){return Z(!A)}),[A]),S=(0,r.useCallback)((function(){return O(f.m.LEARN+"/".concat(e))}),[]);return(0,r.useEffect)((function(){"WRONG_ID"===I&&(O(f.m.PAGE_NOT_FOUND,{replace:!0}),n((0,k.sT)({error:null})))}),[I]),(0,r.useEffect)((function(){return n((0,k.az)((0,t.Z)((0,t.Z)({},a),{},{cardsPack_id:e}))),function(){n((0,k.j$)())}}),[]),(0,V.jsx)(V.Fragment,{children:N?(0,V.jsxs)("div",{className:v,children:[(0,V.jsxs)("div",{className:j,children:[(0,V.jsx)(C.C,{linkToPacks:!0,title:N,hasButtons:!!F.current,buttonClick:w?P:S}),B&&(0,V.jsx)("div",{className:b,children:(0,V.jsx)(l.F,{src:T,alt:"cover",className:q})}),!!F.current&&(0,V.jsx)(m.N,{forCards:!0})]}),(0,V.jsx)(ge,{isMine:w,showButton:!!F.current,handleTitleButton:P}),(0,V.jsx)(u.$,{forCards:!0}),A&&(0,V.jsx)(Y,{isOpened:A,onClose:P,cardsPack_id:e||""})]}):(0,V.jsx)(_.A,{})})}}}]);
//# sourceMappingURL=909.b2cb0cfe.chunk.js.map