"use strict";(self.webpackChunkcards=self.webpackChunkcards||[]).push([[909],{5909:function(e,n,a){a.r(n),a.d(n,{Cards:function(){return fe}});var t=a(1413),s=a(885),r=a(2791),d=a(1835),i=a.n(d),o=a(7689),l=a(6977),c=a(3745),u=a(2142),m=a(2599),_=a(6329),C=a(3294),f=a(4122),p=a(1015),h=a(395),g="Cards_cardsContainer__aYsFI",x="Cards_cards__controlBlock__qTx-z",v="Cards_imgContainer__b9F-k",j="Cards_img__cGe1w",b=a(172),q=a(1607),k=a(7358),w=a(824),N="CardsTable_tableCards__2IL8g",T="CardsTable_cards__emptyBlock__Zf3yi",I="CardsTable_cards__emptyTitle__2rNiu",y="CardsTable_addButton__qsLXM",O=a(8447),D=a(7892),A=a.n(D),Z=a(4165),B=a(5861),E=a(5705),M=a(5680),P=a(8142),S=a(8726),F=a(4472),R=a(6732),U={selectContainer:"AddEditCard_selectContainer__6UPPR",addImageBlock:"AddEditCard_addImageBlock__cVyCq",dargOver:"AddEditCard_dargOver__AumPn",addImageBlockTitle:"AddEditCard_addImageBlockTitle__4Hfe0",hidden:"AddEditCard_hidden__SsOwQ",imageContainer:"AddEditCard_imageContainer__+hm0Q",image:"AddEditCard_image__APHyn"},L=a(184),V=[{id:"text",label:"Text"},{id:"picture",label:"Picture"}],z=(0,r.memo)((function(e){var n=e.isOpened,a=e.onClose,d=e.cardsPack_id,o=void 0===d?"":d,l=e.cardsData,c=(0,f.T)(),u=i()((null===l||void 0===l?void 0:l.questionImg)||"",{mimeRequired:!0}),m=u?V[1].id:V[0].id,_=(0,r.useState)(m),C=(0,s.Z)(_,2),p=C[0],h=C[1],g=(0,r.useState)(u?null===l||void 0===l?void 0:l.questionImg:""),x=(0,s.Z)(g,2),v=x[0],j=x[1],q=(0,r.useState)(null),k=(0,s.Z)(q,2),w=k[0],N=k[1],T=(0,r.useState)(!1),I=(0,s.Z)(T,2),y=I[0],O=I[1],D="text"!==p,A=(0,r.useRef)(),z={size:(null===w||void 0===w?void 0:w.size)||0,type:(null===w||void 0===w?void 0:w.type)||"",selectedItem:D,isImageExist:!!v},Q={questionImg:"",question:(null===l||void 0===l?void 0:l.question)||"",answer:(null===l||void 0===l?void 0:l.answer)||""},G=(0,E.TA)({initialValues:Q,validationSchema:R.M8,validate:function(){return(0,R.ap)(z)},onSubmit:function(e){var n=D?"":e.question,s=w||v?v:" ",r=e.answer!==Q.answer,d=e.question!==Q.question;l&&(w||r||d)&&c((0,b.NB)((0,t.Z)((0,t.Z)({},e),{},{id:(null===l||void 0===l?void 0:l.id)||"",questionImg:s}))),l||c((0,b.zJ)((0,t.Z)((0,t.Z)({},e),{},{question:n,questionImg:v,cardsPack_id:o}))),a()}}),Y=function(){var e=(0,B.Z)((0,Z.Z)().mark((function e(n){var a;return(0,Z.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,"files"in n.target&&n.target.files?N(n.target.files[0]):"dataTransfer"in n&&N(n.dataTransfer.files[0]),e.next=5,(0,F.f)(n);case 5:a=e.sent,G.setFieldValue("question"," "),G.setTouched((0,t.Z)((0,t.Z)({},G.touched),{},{questionImg:!0})),j(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log("Error File Upload: ",e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(n){return e.apply(this,arguments)}}(),H=function(e){"Enter"===e.key&&G.handleSubmit()},J=(0,r.useCallback)((function(e){p!==e&&(h(e),G.resetForm(),G.setValues({questionImg:"",question:"",answer:""}),G.setFieldError("questionImg",""),j(""),N(null))}),[p]);return(0,r.useEffect)((function(){D||setTimeout((function(){var e;return null===A||void 0===A||null===(e=A.current)||void 0===e?void 0:e.focus()}),50)}),[]),(0,L.jsxs)(S.N,{title:l?"Edit card":"Add new card",onOkButtonText:l?"Update":"Create",onOk:G.handleSubmit,isOpened:n,onClose:a,children:[(0,L.jsxs)("div",{className:U.selectContainer,children:[(0,L.jsx)("p",{className:U.selectTitle,children:"Choose a question format"}),(0,L.jsx)(P.A,{positionOptions:"left",initValue:p,options:V,selectedOption:J})]}),(0,L.jsxs)("form",{onSubmit:G.handleSubmit,children:["text"===p?(0,L.jsx)(M.t,(0,t.Z)({inputRef:A,label:"Question",autoComplete:"new-password",error:G.touched.question&&!!G.errors.question,helperText:G.touched.question&&G.errors.question,onKeyDown:H},G.getFieldProps("question"))):(0,L.jsxs)("label",{className:"".concat(U.addImageBlock," ").concat(y?U.dargOver:""),onDragOver:function(e){e.preventDefault(),O(!0)},onDragLeave:function(){return O(!1)},onDrop:Y,children:[(0,L.jsxs)("p",{className:U.addImageBlockTitle,children:["Drag your image here or click to upload.",(0,L.jsx)("br",{}),"File size should be less than 100kb"]}),(0,L.jsx)(M.t,(0,t.Z)((0,t.Z)({type:"file",inputProps:{accept:".jpg,.jpeg,.gif,.png,.webp"},className:U.hidden,error:G.touched.questionImg&&!!G.errors.questionImg,helperText:G.touched.questionImg&&G.errors.questionImg},G.getFieldProps("questionImg")),{},{onChange:Y})),!!v&&(0,L.jsx)("div",{className:U.imageContainer,children:(0,L.jsx)("img",{src:v,alt:"cover",className:U.image})})]}),(0,L.jsx)(M.t,(0,t.Z)({label:"Answer",autoComplete:"new-password",autoFocus:n,error:G.touched.answer&&!!G.errors.answer,helperText:G.touched.answer&&G.errors.answer,onKeyDown:H},G.getFieldProps("answer")))]})]})})),Q=a(4001),G=a(6479),Y=function(e){var n=e.id,a=e.isOpened,t=e.onClose,s=(0,f.T)(),r=function(){s((0,b.AM)(n)),t()};return(0,G.P)(r),(0,L.jsx)(Q.V,{title:"Delete card",primaryColor:"red",onOkButtonText:"Delete",onOk:r,isOpened:a,onClose:t,children:"Are you sure you want to delete current card? Confirm deletion"})},H="CardActionsMenu_menuContainer__78870",J="CardActionsMenu_menu__aneCs",K="CardActionsMenu_openMenuLeft__SOq5z",W="CardActionsMenu_menuItem__5n86X",X=a(6492),$=a(5325),ee=function(e){var n=e.parentRef,a=e.handleEdit,t=e.handleDelete,s=e.closeMenu,d=(0,r.useRef)();return(0,$.t)(s,d,n),(0,X.q)(s),(0,L.jsxs)("ul",{ref:d,className:J,onClick:s,children:[(0,L.jsx)("li",{className:W,onMouseDown:a}),(0,L.jsx)("li",{className:W,onMouseDown:t})]})},ne=function(e){var n=e.cardID,a=e.answer,d=e.question,i=e.questionImg,o=(0,r.useState)(!1),l=(0,s.Z)(o,2),c=l[0],u=l[1],m=c?K:"",_={deleteOpened:!1,editOpened:!1},C=(0,r.useState)(_),f=(0,s.Z)(C,2),p=f[0],h=f[1],g=(0,r.useRef)(),x={id:n,answer:a,question:d,questionImg:i},v=function(){return u(!c)},j=function(){return h(_)};return(0,L.jsxs)(L.Fragment,{children:[p.editOpened&&(0,L.jsx)(z,{isOpened:p.editOpened,onClose:j,cardsData:x}),p.deleteOpened&&(0,L.jsx)(Y,{isOpened:p.deleteOpened,id:n,onClose:j}),(0,L.jsx)("div",{ref:g,className:"".concat(H," ").concat(m),onClick:v,children:c&&(0,L.jsx)(ee,{parentRef:g,handleEdit:function(){return h((0,t.Z)((0,t.Z)({},p),{},{editOpened:!p.editOpened}))},handleDelete:function(){return h((0,t.Z)((0,t.Z)({},p),{},{deleteOpened:!p.deleteOpened}))},closeMenu:v})})]})},ae="CardsTableBody_cardImageWrapper__8RZer",te="CardsTableBody_cardName__Qe-Vb",se="CardsTableBody_cardNameAdaptive__u389k",re="CardsTableBody_cardImage__wUpg8",de="CardsTableBody_tableCards__body__AC4ub",ie="CardsTableBody_tableCards__bodyRow__5LfMu",oe="CardsTableBody_tableCards__bodyCellContent__Jfoqc",le="CardsTableBody_tableCards__bodyCell__PDQUj",ce="CardsTableBody_tableCards__bodyCellTitle__5SgyV",ue="CardsTableBody_rating__G2Emo",me=function(e){var n=e.heads,a=e.isMine,t=(0,f.C)((function(e){return e.cards.tableData})),s=(0,h.DU)();return(0,L.jsx)("tbody",{className:de,children:t.map((function(e){return(0,L.jsxs)("tr",{className:ie,children:[n.map((function(n,a){var t=i()(e.questionImg,{mimeRequired:!0});return(0,L.jsx)("td",{className:le,scope:"row",onClick:function(){return n=e._id,a=e.cardsPack_id,void("loading"!==e.requestStatus&&s(C.m.LEARN+"/".concat(a),{state:{cardId:n}}));var n,a},children:(0,L.jsxs)("div",{className:oe,children:[(0,L.jsx)("div",{className:ce,children:0===a?"".concat(t?"":e[n.id]):n.label}),"question"===n.id&&t&&(0,L.jsx)("div",{className:ae,children:(0,L.jsx)("img",{src:e.questionImg,alt:"deckCover",className:re})}),"grade"===n.id?(0,L.jsx)(O.Z,{className:ue,value:e[n.id],readOnly:!0}):(0,L.jsx)("p",{className:"".concat(se," ").concat("question"===n.id&&t?te:""),children:"updated"===n.id?A()(e[n.id]).format("DD.MM.YYYY"):e[n.id]})]})},n.id)})),(0,L.jsx)("td",{className:le,children:a&&(0,L.jsx)(ne,{cardID:e._id,answer:e.answer,question:e.question,questionImg:e.questionImg})})]},e._id)}))})},_e=[{id:"question",label:"Question"},{id:"answer",label:"Answer"},{id:"grade",label:"Grade"},{id:"updated",label:"Last updated"}],Ce=(0,r.memo)((function(e){var n=e.isMine,a=e.showButton,t=e.handleTitleButton,s=(0,f.C)((function(e){return e.cards.status})),r=(0,f.C)((function(e){return e.cards.cardsData.cardsTotalCount})),d=(0,f.C)((function(e){return e.cards.queryParams.pageCount}));return(0,L.jsx)(L.Fragment,{children:r?(0,L.jsxs)("table",{className:N,children:[(0,L.jsx)(w.E,{heads:_e,forCards:!0,withActions:n}),"loading"===s?(0,L.jsx)(k.U,{columnsCount:_e.length,rowsCount:d,withActions:n}):(0,L.jsx)(me,{heads:_e,isMine:n})]}):(0,L.jsx)(L.Fragment,{children:"loading"===s?(0,L.jsx)(m.A,{}):(0,L.jsxs)("div",{className:T,children:[(0,L.jsxs)("h3",{className:I,children:["No cards found."," ",n&&!a?"Click add new card to fill this pack":""]}),n&&!a&&(0,L.jsx)(q.o,{className:y,onClick:t,children:(0,L.jsx)("p",{children:"Add new card"})})]})})})})),fe=function(){var e=(0,o.UO)().id,n=(0,f.T)(),a=(0,p.v)(),d=(0,f.C)((function(e){return e.cards.cardsData.cardsTotalCount})),q=(0,f.C)(l.q),k=(0,f.C)((function(e){return e.cards.cardsData.packName})),w=(0,f.C)((function(e){return e.cards.cardsData.packDeckCover})),N=(0,f.C)((function(e){return e.cards.error})),T=(0,h.DU)(),I=(0,r.useState)(!1),y=(0,s.Z)(I,2),O=y[0],D=y[1],A=i()(w,{mimeRequired:!0}),Z=a.cardQuestion?1:0,B=(0,r.useRef)(d||Z||0);d&&!B.current&&B.current++;var E=(0,r.useCallback)((function(){return D(!O)}),[O]),M=(0,r.useCallback)((function(){return T(C.m.LEARN+"/".concat(e))}),[]);return(0,r.useEffect)((function(){"WRONG_ID"===N&&(T(C.m.PAGE_NOT_FOUND,{replace:!0}),n((0,b.sT)({error:null})))}),[N]),(0,r.useEffect)((function(){return n((0,b.az)((0,t.Z)((0,t.Z)({},a),{},{cardsPack_id:e}))),function(){n((0,b.j$)())}}),[]),(0,L.jsx)(L.Fragment,{children:k?(0,L.jsxs)("div",{className:g,children:[(0,L.jsxs)("div",{className:x,children:[(0,L.jsx)(_.C,{linkToPacks:!0,title:k,hasButtons:!!B.current,buttonClick:q?E:M}),A&&(0,L.jsx)("div",{className:v,children:(0,L.jsx)("img",{src:w,alt:"cover",className:j})}),!!B.current&&(0,L.jsx)(u.N,{forCards:!0})]}),(0,L.jsx)(Ce,{isMine:q,showButton:!!B.current,handleTitleButton:E}),(0,L.jsx)(c.$,{forCards:!0}),O&&(0,L.jsx)(z,{isOpened:O,onClose:E,cardsPack_id:e||""})]}):(0,L.jsx)(m.A,{})})}}}]);
//# sourceMappingURL=909.1398d7f5.chunk.js.map