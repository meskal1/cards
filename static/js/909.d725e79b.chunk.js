"use strict";(self.webpackChunkcards=self.webpackChunkcards||[]).push([[909],{5515:function(e,n,a){a.d(n,{F:function(){return f}});var s=a(1413),t=a(885),r=a(5987),i=a(2791);var d=a.p+"static/media/addIconWhite.0d060264c68e4b3f2d0880ccf9abc566.svg",o=a(4346),c="ClickableImage_smallImg__TzOOd",l="ClickableImage_fullSizedImgWrapper__1IoAK",u="ClickableImage_fullSizedImg__y4QsX",m="ClickableImage_closeImg__+pU2M",_=a(184),C=["className"],f=function(e){var n=e.className,a=(0,r.Z)(e,C),f=(0,i.useState)(!1),p=(0,t.Z)(f,2),g=p[0],h=p[1],x=(0,i.useState)(!1),v=(0,t.Z)(x,2),j=v[0],b=v[1],q=n?"".concat(n," ").concat(c):c,k=function(){return h(!1)};return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("img",(0,s.Z)({className:q,onClick:function(){return h(!0)},onError:function(){return b(!0)}},a)),!j&&(0,_.jsx)(o.I,{isOpened:g,onClose:k,children:(0,_.jsxs)("div",{className:l,children:[(0,_.jsx)("img",{className:u,src:a.src}),(0,_.jsx)("img",{className:m,src:d,onClick:k})]})})]})}},5909:function(e,n,a){a.r(n),a.d(n,{Cards:function(){return he}});var s=a(1413),t=a(885),r=a(2791),i=a(1835),d=a.n(i),o=a(7689),c=a(6977),l=a(5515),u=a(3745),m=a(2142),_=a(2599),C=a(6329),f=a(3294),p=a(9911),g=a(9565),h=a(1015),x=a(395),v="Cards_cardsContainer__aYsFI",j="Cards_cards__controlBlock__qTx-z",b="Cards_imgContainer__b9F-k",q="Cards_img__cGe1w",k=a(172),w=a(1607),N=a(7358),I=a(824),T="CardsTable_tableCards__2IL8g",O="CardsTable_cards__emptyBlock__Zf3yi",y="CardsTable_cards__emptyTitle__2rNiu",A="CardsTable_addButton__qsLXM",D=a(8447),Z=a(7892),B=a.n(Z),E=a(4958),S=a(4165),F=a(5861),P=a(5705),M=a(5680),R=a(8142),U=a(8726),z=a(4472),L=a(6732),Q={selectContainer:"AddEditCard_selectContainer__6UPPR",addImageBlock:"AddEditCard_addImageBlock__cVyCq",dargOver:"AddEditCard_dargOver__AumPn",addImageBlockTitle:"AddEditCard_addImageBlockTitle__4Hfe0",hidden:"AddEditCard_hidden__SsOwQ",imageContainer:"AddEditCard_imageContainer__+hm0Q",image:"AddEditCard_image__APHyn"},V=a(184),G=[{id:"text",label:"Text"},{id:"picture",label:"Picture"}],Y=(0,r.memo)((function(e){var n=e.isOpened,a=e.onClose,i=e.cardsPack_id,o=void 0===i?"":i,c=e.cardsData,l=(0,p.T)(),u=d()((null===c||void 0===c?void 0:c.questionImg)||"",{mimeRequired:!0}),m=u?G[1].id:G[0].id,_=(0,r.useState)(m),C=(0,t.Z)(_,2),f=C[0],g=C[1],h=(0,r.useState)(u?null===c||void 0===c?void 0:c.questionImg:""),x=(0,t.Z)(h,2),v=x[0],j=x[1],b=(0,r.useState)(null),q=(0,t.Z)(b,2),w=q[0],N=q[1],I=(0,r.useState)(!1),T=(0,t.Z)(I,2),O=T[0],y=T[1],A="text"!==f,D=(0,r.useRef)(),Z={size:(null===w||void 0===w?void 0:w.size)||0,type:(null===w||void 0===w?void 0:w.type)||"",selectedItem:A,isImageExist:!!v},B={questionImg:"",question:(null===c||void 0===c?void 0:c.question)||"",answer:(null===c||void 0===c?void 0:c.answer)||""},Y=(0,P.TA)({initialValues:B,validationSchema:L.GB,validate:function(){return(0,L.ap)(Z)},onSubmit:function(e){var n=A?"":e.question,s=w||v?v:" ",t=e.answer!==B.answer,r=e.question!==B.question;c&&(w||t||r)&&l((0,k.NB)({answer:(0,E.v)(e.answer),question:(0,E.v)(e.question),id:(null===c||void 0===c?void 0:c.id)||"",questionImg:s})),c||l((0,k.zJ)({answer:(0,E.v)(e.answer),question:(0,E.v)(n),questionImg:v,cardsPack_id:o})),a()}}),W=function(){var e=(0,F.Z)((0,S.Z)().mark((function e(n){var a;return(0,S.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,"files"in n.target&&n.target.files?N(n.target.files[0]):"dataTransfer"in n&&N(n.dataTransfer.files[0]),e.next=5,(0,z.f)(n);case 5:a=e.sent,Y.setFieldValue("question"," "),Y.setTouched((0,s.Z)((0,s.Z)({},Y.touched),{},{questionImg:!0})),j(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log("Error File Upload: ",e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(n){return e.apply(this,arguments)}}(),K=function(e){"Enter"===e.key&&Y.handleSubmit()},X=(0,r.useCallback)((function(e){f!==e&&(g(e),Y.resetForm(),Y.setValues({questionImg:"",question:"",answer:""}),Y.setFieldError("questionImg",""),j(""),N(null))}),[f]);return(0,r.useEffect)((function(){A||setTimeout((function(){var e;return null===D||void 0===D||null===(e=D.current)||void 0===e?void 0:e.focus()}),50)}),[]),(0,V.jsxs)(U.N,{title:c?"Edit card":"Add new card",onOkButtonText:c?"Update":"Create",onOk:Y.handleSubmit,isOpened:n,onClose:a,children:[(0,V.jsxs)("div",{className:Q.selectContainer,children:[(0,V.jsx)("p",{className:Q.selectTitle,children:"Choose a question format"}),(0,V.jsx)(R.A,{positionOptions:"left",initValue:f,options:G,selectedOption:X})]}),(0,V.jsxs)("form",{onSubmit:Y.handleSubmit,children:["text"===f?(0,V.jsx)(M.t,(0,s.Z)({inputRef:D,label:"Question",autoComplete:"new-password",error:Y.touched.question&&!!Y.errors.question,helperText:Y.touched.question&&Y.errors.question,onKeyDown:K},Y.getFieldProps("question"))):(0,V.jsxs)("label",{className:"".concat(Q.addImageBlock," ").concat(O?Q.dargOver:""),onDragOver:function(e){e.preventDefault(),y(!0)},onDragLeave:function(){return y(!1)},onDrop:W,children:[(0,V.jsxs)("p",{className:Q.addImageBlockTitle,children:["Drag your image here or click to upload.",(0,V.jsx)("br",{}),"File size should be less than 100kb"]}),(0,V.jsx)(M.t,(0,s.Z)((0,s.Z)({type:"file",inputProps:{accept:".jpg,.jpeg,.gif,.png,.webp,.svg"},className:Q.hidden,error:Y.touched.questionImg&&!!Y.errors.questionImg,helperText:Y.touched.questionImg&&Y.errors.questionImg},Y.getFieldProps("questionImg")),{},{onChange:W})),!!v&&(0,V.jsx)("div",{className:Q.imageContainer,children:(0,V.jsx)("img",{src:v,alt:"cover",className:Q.image})})]}),(0,V.jsx)(M.t,(0,s.Z)({label:"Answer",autoComplete:"new-password",autoFocus:n,error:Y.touched.answer&&!!Y.errors.answer,helperText:Y.touched.answer&&Y.errors.answer,onKeyDown:K},Y.getFieldProps("answer")))]})]})})),W=a(4001),K=a(6479),X=function(e){var n=e.id,a=e.isOpened,s=e.onClose,t=(0,p.T)(),r=function(){t((0,k.AM)(n)),s()};return(0,K.P)(r),(0,V.jsx)(W.V,{title:"Delete card",primaryColor:"red",onOkButtonText:"Delete",onOk:r,isOpened:a,onClose:s,children:"Are you sure you want to delete current card? Confirm deletion"})},H="CardActionsMenu_menuContainer__78870",J="CardActionsMenu_menu__aneCs",$="CardActionsMenu_openMenuLeft__SOq5z",ee="CardActionsMenu_menuItem__5n86X",ne=a(6492),ae=a(5325),se=function(e){var n=e.parentRef,a=e.handleEdit,s=e.handleDelete,t=e.closeMenu,i=(0,r.useRef)();return(0,ae.t)(t,i,n),(0,ne.q)(t),(0,V.jsxs)("ul",{ref:i,className:J,onClick:t,children:[(0,V.jsx)("li",{className:ee,onMouseDown:a}),(0,V.jsx)("li",{className:ee,onMouseDown:s})]})},te=function(e){var n=e.cardID,a=e.answer,i=e.question,d=e.questionImg,o=(0,r.useState)(!1),c=(0,t.Z)(o,2),l=c[0],u=c[1],m=l?$:"",_={deleteOpened:!1,editOpened:!1},C=(0,r.useState)(_),f=(0,t.Z)(C,2),p=f[0],g=f[1],h=(0,r.useRef)(),x={id:n,answer:a,question:i,questionImg:d},v=function(){return u(!l)},j=function(){return g(_)};return(0,V.jsxs)(V.Fragment,{children:[p.editOpened&&(0,V.jsx)(Y,{isOpened:p.editOpened,onClose:j,cardsData:x}),p.deleteOpened&&(0,V.jsx)(X,{isOpened:p.deleteOpened,id:n,onClose:j}),(0,V.jsx)("div",{ref:h,className:"".concat(H," ").concat(m),onClick:v,children:l&&(0,V.jsx)(se,{parentRef:h,handleEdit:function(){return g((0,s.Z)((0,s.Z)({},p),{},{editOpened:!p.editOpened}))},handleDelete:function(){return g((0,s.Z)((0,s.Z)({},p),{},{deleteOpened:!p.deleteOpened}))},closeMenu:v})})]})},re="CardsTableBody_cardImageWrapper__8RZer",ie="CardsTableBody_cardName__Qe-Vb",de="CardsTableBody_cardNameAdaptive__u389k",oe="CardsTableBody_cardImage__wUpg8",ce="CardsTableBody_tableCards__body__AC4ub",le="CardsTableBody_tableCards__bodyRow__5LfMu",ue="CardsTableBody_tableCards__bodyCellContent__Jfoqc",me="CardsTableBody_tableCards__bodyCell__PDQUj",_e="CardsTableBody_tableCards__bodyCellTitle__5SgyV",Ce="CardsTableBody_rating__G2Emo",fe=function(e){var n=e.heads,a=e.isMine,s=(0,g.C)((function(e){return e.cards.tableData})),t=(0,x.DU)(),r=function(e){return e.stopPropagation()};return(0,V.jsx)("tbody",{className:ce,children:s.map((function(e){return(0,V.jsxs)("tr",{className:le,children:[n.map((function(n,a){var s=d()(e.questionImg,{mimeRequired:!0});return(0,V.jsx)("td",{className:me,scope:"row",onClick:function(){return n=e._id,a=e.cardsPack_id,void("loading"!==e.requestStatus&&t(f.m.LEARN+"/".concat(a),{state:{cardId:n}}));var n,a},children:(0,V.jsxs)("div",{className:ue,children:[(0,V.jsx)("div",{className:_e,children:0===a?"".concat(s?"":e[n.id]):n.label}),"question"===n.id&&s&&(0,V.jsx)("div",{className:re,onClick:r,children:(0,V.jsx)(l.F,{src:e.questionImg,alt:"deckCover",className:oe})}),"grade"===n.id?(0,V.jsx)(D.Z,{className:Ce,value:e[n.id],readOnly:!0}):(0,V.jsx)("p",{className:"".concat(de," ").concat("question"===n.id&&s?ie:""),children:"updated"===n.id?B()(e[n.id]).format("DD.MM.YYYY"):(0,E.v)(e[n.id]+"")})]})},n.id)})),(0,V.jsx)("td",{className:me,children:a&&(0,V.jsx)(te,{cardID:e._id,answer:e.answer,question:e.question,questionImg:e.questionImg})})]},e._id)}))})},pe=[{id:"question",label:"Question"},{id:"answer",label:"Answer"},{id:"grade",label:"Grade"},{id:"updated",label:"Last updated"}],ge=(0,r.memo)((function(e){var n=e.isMine,a=e.showButton,s=e.handleTitleButton,t=(0,g.C)((function(e){return e.cards.status})),r=(0,g.C)((function(e){return e.cards.cardsData.cardsTotalCount})),i=(0,g.C)((function(e){return e.cards.queryParams.pageCount}));return(0,V.jsx)(V.Fragment,{children:r?(0,V.jsxs)("table",{className:T,children:[(0,V.jsx)(I.E,{heads:pe,forCards:!0,withActions:n}),"loading"===t?(0,V.jsx)(N.U,{columnsCount:pe.length,rowsCount:i,withActions:n}):(0,V.jsx)(fe,{heads:pe,isMine:n})]}):(0,V.jsx)(V.Fragment,{children:"loading"===t?(0,V.jsx)(_.A,{}):(0,V.jsxs)("div",{className:O,children:[(0,V.jsxs)("h3",{className:y,children:["No cards found."," ",n&&!a?"Click add new card to fill this pack":""]}),n&&!a&&(0,V.jsx)(w.o,{className:A,onClick:s,children:(0,V.jsx)("p",{children:"Add new card"})})]})})})})),he=function(){var e=(0,o.UO)().id,n=(0,p.T)(),a=(0,h.v)(),i=(0,g.C)((function(e){return e.cards.cardsData.cardsTotalCount})),w=(0,g.C)(c.q),N=(0,g.C)((function(e){return e.cards.cardsData.packName})),I=(0,g.C)((function(e){return e.cards.cardsData.packDeckCover})),T=(0,g.C)((function(e){return e.cards.error})),O=(0,x.DU)(),y=(0,r.useState)(!1),A=(0,t.Z)(y,2),D=A[0],Z=A[1],B=d()(I,{mimeRequired:!0}),E=a.cardQuestion?1:0,S=(0,r.useRef)(i||E||0);i&&!S.current&&S.current++;var F=(0,r.useCallback)((function(){return Z(!D)}),[D]),P=(0,r.useCallback)((function(){return O(f.m.LEARN+"/".concat(e))}),[]);return(0,r.useEffect)((function(){"WRONG_ID"===T&&(O(f.m.PAGE_NOT_FOUND,{replace:!0}),n((0,k.sT)({error:null})))}),[T]),(0,r.useEffect)((function(){return n((0,k.az)((0,s.Z)((0,s.Z)({},a),{},{cardsPack_id:e}))),function(){n((0,k.j$)())}}),[]),(0,V.jsx)(V.Fragment,{children:N?(0,V.jsxs)("div",{className:v,children:[(0,V.jsxs)("div",{className:j,children:[(0,V.jsx)(C.C,{linkToPacks:!0,title:N,hasButtons:!!S.current,buttonClick:w?F:P}),B&&(0,V.jsx)("div",{className:b,children:(0,V.jsx)(l.F,{src:I,alt:"cover",className:q})}),!!S.current&&(0,V.jsx)(m.N,{forCards:!0})]}),(0,V.jsx)(ge,{isMine:w,showButton:!!S.current,handleTitleButton:F}),(0,V.jsx)(u.$,{forCards:!0}),D&&(0,V.jsx)(Y,{isOpened:D,onClose:F,cardsPack_id:e||""})]}):(0,V.jsx)(_.A,{})})}}}]);
//# sourceMappingURL=909.d725e79b.chunk.js.map