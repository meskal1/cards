"use strict";(self.webpackChunkcards=self.webpackChunkcards||[]).push([[909],{5909:function(e,n,a){a.r(n),a.d(n,{Cards:function(){return he}});var t=a(1413),s=a(885),r=a(2791),d=a(1835),i=a.n(d),o=a(7689),l=a(6977),c=a(3745),u=a(2142),m=a(2599),_=a(6329),C=a(3294),f=a(9911),p=a(9565),h=a(1015),g=a(395),v="Cards_cardsContainer__aYsFI",x="Cards_cards__controlBlock__qTx-z",j="Cards_imgContainer__b9F-k",b="Cards_img__cGe1w",q=a(172),w=a(1607),k=a(7358),N=a(824),T="CardsTable_tableCards__2IL8g",I="CardsTable_cards__emptyBlock__Zf3yi",y="CardsTable_cards__emptyTitle__2rNiu",O="CardsTable_addButton__qsLXM",D=a(8447),A=a(7892),B=a.n(A),Z=a(4958),E=a(4165),P=a(5861),M=a(5705),S=a(5680),F=a(8142),R=a(8726),U=a(4472),L=a(6732),V={selectContainer:"AddEditCard_selectContainer__6UPPR",addImageBlock:"AddEditCard_addImageBlock__cVyCq",dargOver:"AddEditCard_dargOver__AumPn",addImageBlockTitle:"AddEditCard_addImageBlockTitle__4Hfe0",hidden:"AddEditCard_hidden__SsOwQ",imageContainer:"AddEditCard_imageContainer__+hm0Q",image:"AddEditCard_image__APHyn"},z=a(184),Q=[{id:"text",label:"Text"},{id:"picture",label:"Picture"}],G=(0,r.memo)((function(e){var n=e.isOpened,a=e.onClose,d=e.cardsPack_id,o=void 0===d?"":d,l=e.cardsData,c=(0,f.T)(),u=i()((null===l||void 0===l?void 0:l.questionImg)||"",{mimeRequired:!0}),m=u?Q[1].id:Q[0].id,_=(0,r.useState)(m),C=(0,s.Z)(_,2),p=C[0],h=C[1],g=(0,r.useState)(u?null===l||void 0===l?void 0:l.questionImg:""),v=(0,s.Z)(g,2),x=v[0],j=v[1],b=(0,r.useState)(null),w=(0,s.Z)(b,2),k=w[0],N=w[1],T=(0,r.useState)(!1),I=(0,s.Z)(T,2),y=I[0],O=I[1],D="text"!==p,A=(0,r.useRef)(),B={size:(null===k||void 0===k?void 0:k.size)||0,type:(null===k||void 0===k?void 0:k.type)||"",selectedItem:D,isImageExist:!!x},G={questionImg:"",question:(null===l||void 0===l?void 0:l.question)||"",answer:(null===l||void 0===l?void 0:l.answer)||""},Y=(0,M.TA)({initialValues:G,validationSchema:L.GB,validate:function(){return(0,L.ap)(B)},onSubmit:function(e){var n=D?"":e.question,t=k||x?x:" ",s=e.answer!==G.answer,r=e.question!==G.question;l&&(k||s||r)&&c((0,q.NB)({answer:(0,Z.v)(e.answer),question:(0,Z.v)(e.question),id:(null===l||void 0===l?void 0:l.id)||"",questionImg:t})),l||c((0,q.zJ)({answer:(0,Z.v)(e.answer),question:(0,Z.v)(n),questionImg:x,cardsPack_id:o})),a()}}),H=function(){var e=(0,P.Z)((0,E.Z)().mark((function e(n){var a;return(0,E.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,"files"in n.target&&n.target.files?N(n.target.files[0]):"dataTransfer"in n&&N(n.dataTransfer.files[0]),e.next=5,(0,U.f)(n);case 5:a=e.sent,Y.setFieldValue("question"," "),Y.setTouched((0,t.Z)((0,t.Z)({},Y.touched),{},{questionImg:!0})),j(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log("Error File Upload: ",e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(n){return e.apply(this,arguments)}}(),J=function(e){"Enter"===e.key&&Y.handleSubmit()},K=(0,r.useCallback)((function(e){p!==e&&(h(e),Y.resetForm(),Y.setValues({questionImg:"",question:"",answer:""}),Y.setFieldError("questionImg",""),j(""),N(null))}),[p]);return(0,r.useEffect)((function(){D||setTimeout((function(){var e;return null===A||void 0===A||null===(e=A.current)||void 0===e?void 0:e.focus()}),50)}),[]),(0,z.jsxs)(R.N,{title:l?"Edit card":"Add new card",onOkButtonText:l?"Update":"Create",onOk:Y.handleSubmit,isOpened:n,onClose:a,children:[(0,z.jsxs)("div",{className:V.selectContainer,children:[(0,z.jsx)("p",{className:V.selectTitle,children:"Choose a question format"}),(0,z.jsx)(F.A,{positionOptions:"left",initValue:p,options:Q,selectedOption:K})]}),(0,z.jsxs)("form",{onSubmit:Y.handleSubmit,children:["text"===p?(0,z.jsx)(S.t,(0,t.Z)({inputRef:A,label:"Question",autoComplete:"new-password",error:Y.touched.question&&!!Y.errors.question,helperText:Y.touched.question&&Y.errors.question,onKeyDown:J},Y.getFieldProps("question"))):(0,z.jsxs)("label",{className:"".concat(V.addImageBlock," ").concat(y?V.dargOver:""),onDragOver:function(e){e.preventDefault(),O(!0)},onDragLeave:function(){return O(!1)},onDrop:H,children:[(0,z.jsxs)("p",{className:V.addImageBlockTitle,children:["Drag your image here or click to upload.",(0,z.jsx)("br",{}),"File size should be less than 100kb"]}),(0,z.jsx)(S.t,(0,t.Z)((0,t.Z)({type:"file",inputProps:{accept:".jpg,.jpeg,.gif,.png,.webp,.svg"},className:V.hidden,error:Y.touched.questionImg&&!!Y.errors.questionImg,helperText:Y.touched.questionImg&&Y.errors.questionImg},Y.getFieldProps("questionImg")),{},{onChange:H})),!!x&&(0,z.jsx)("div",{className:V.imageContainer,children:(0,z.jsx)("img",{src:x,alt:"cover",className:V.image})})]}),(0,z.jsx)(S.t,(0,t.Z)({label:"Answer",autoComplete:"new-password",autoFocus:n,error:Y.touched.answer&&!!Y.errors.answer,helperText:Y.touched.answer&&Y.errors.answer,onKeyDown:J},Y.getFieldProps("answer")))]})]})})),Y=a(4001),H=a(6479),J=function(e){var n=e.id,a=e.isOpened,t=e.onClose,s=(0,f.T)(),r=function(){s((0,q.AM)(n)),t()};return(0,H.P)(r),(0,z.jsx)(Y.V,{title:"Delete card",primaryColor:"red",onOkButtonText:"Delete",onOk:r,isOpened:a,onClose:t,children:"Are you sure you want to delete current card? Confirm deletion"})},K="CardActionsMenu_menuContainer__78870",W="CardActionsMenu_menu__aneCs",X="CardActionsMenu_openMenuLeft__SOq5z",$="CardActionsMenu_menuItem__5n86X",ee=a(6492),ne=a(5325),ae=function(e){var n=e.parentRef,a=e.handleEdit,t=e.handleDelete,s=e.closeMenu,d=(0,r.useRef)();return(0,ne.t)(s,d,n),(0,ee.q)(s),(0,z.jsxs)("ul",{ref:d,className:W,onClick:s,children:[(0,z.jsx)("li",{className:$,onMouseDown:a}),(0,z.jsx)("li",{className:$,onMouseDown:t})]})},te=function(e){var n=e.cardID,a=e.answer,d=e.question,i=e.questionImg,o=(0,r.useState)(!1),l=(0,s.Z)(o,2),c=l[0],u=l[1],m=c?X:"",_={deleteOpened:!1,editOpened:!1},C=(0,r.useState)(_),f=(0,s.Z)(C,2),p=f[0],h=f[1],g=(0,r.useRef)(),v={id:n,answer:a,question:d,questionImg:i},x=function(){return u(!c)},j=function(){return h(_)};return(0,z.jsxs)(z.Fragment,{children:[p.editOpened&&(0,z.jsx)(G,{isOpened:p.editOpened,onClose:j,cardsData:v}),p.deleteOpened&&(0,z.jsx)(J,{isOpened:p.deleteOpened,id:n,onClose:j}),(0,z.jsx)("div",{ref:g,className:"".concat(K," ").concat(m),onClick:x,children:c&&(0,z.jsx)(ae,{parentRef:g,handleEdit:function(){return h((0,t.Z)((0,t.Z)({},p),{},{editOpened:!p.editOpened}))},handleDelete:function(){return h((0,t.Z)((0,t.Z)({},p),{},{deleteOpened:!p.deleteOpened}))},closeMenu:x})})]})},se="CardsTableBody_cardImageWrapper__8RZer",re="CardsTableBody_cardName__Qe-Vb",de="CardsTableBody_cardNameAdaptive__u389k",ie="CardsTableBody_cardImage__wUpg8",oe="CardsTableBody_tableCards__body__AC4ub",le="CardsTableBody_tableCards__bodyRow__5LfMu",ce="CardsTableBody_tableCards__bodyCellContent__Jfoqc",ue="CardsTableBody_tableCards__bodyCell__PDQUj",me="CardsTableBody_tableCards__bodyCellTitle__5SgyV",_e="CardsTableBody_rating__G2Emo",Ce=function(e){var n=e.heads,a=e.isMine,t=(0,p.C)((function(e){return e.cards.tableData})),s=(0,g.DU)();return(0,z.jsx)("tbody",{className:oe,children:t.map((function(e){return(0,z.jsxs)("tr",{className:le,children:[n.map((function(n,a){var t=i()(e.questionImg,{mimeRequired:!0});return(0,z.jsx)("td",{className:ue,scope:"row",onClick:function(){return n=e._id,a=e.cardsPack_id,void("loading"!==e.requestStatus&&s(C.m.LEARN+"/".concat(a),{state:{cardId:n}}));var n,a},children:(0,z.jsxs)("div",{className:ce,children:[(0,z.jsx)("div",{className:me,children:0===a?"".concat(t?"":e[n.id]):n.label}),"question"===n.id&&t&&(0,z.jsx)("div",{className:se,children:(0,z.jsx)("img",{src:e.questionImg,alt:"deckCover",className:ie})}),"grade"===n.id?(0,z.jsx)(D.Z,{className:_e,value:e[n.id],readOnly:!0}):(0,z.jsx)("p",{className:"".concat(de," ").concat("question"===n.id&&t?re:""),children:"updated"===n.id?B()(e[n.id]).format("DD.MM.YYYY"):(0,Z.v)(e[n.id]+"")})]})},n.id)})),(0,z.jsx)("td",{className:ue,children:a&&(0,z.jsx)(te,{cardID:e._id,answer:e.answer,question:e.question,questionImg:e.questionImg})})]},e._id)}))})},fe=[{id:"question",label:"Question"},{id:"answer",label:"Answer"},{id:"grade",label:"Grade"},{id:"updated",label:"Last updated"}],pe=(0,r.memo)((function(e){var n=e.isMine,a=e.showButton,t=e.handleTitleButton,s=(0,p.C)((function(e){return e.cards.status})),r=(0,p.C)((function(e){return e.cards.cardsData.cardsTotalCount})),d=(0,p.C)((function(e){return e.cards.queryParams.pageCount}));return(0,z.jsx)(z.Fragment,{children:r?(0,z.jsxs)("table",{className:T,children:[(0,z.jsx)(N.E,{heads:fe,forCards:!0,withActions:n}),"loading"===s?(0,z.jsx)(k.U,{columnsCount:fe.length,rowsCount:d,withActions:n}):(0,z.jsx)(Ce,{heads:fe,isMine:n})]}):(0,z.jsx)(z.Fragment,{children:"loading"===s?(0,z.jsx)(m.A,{}):(0,z.jsxs)("div",{className:I,children:[(0,z.jsxs)("h3",{className:y,children:["No cards found."," ",n&&!a?"Click add new card to fill this pack":""]}),n&&!a&&(0,z.jsx)(w.o,{className:O,onClick:t,children:(0,z.jsx)("p",{children:"Add new card"})})]})})})})),he=function(){var e=(0,o.UO)().id,n=(0,f.T)(),a=(0,h.v)(),d=(0,p.C)((function(e){return e.cards.cardsData.cardsTotalCount})),w=(0,p.C)(l.q),k=(0,p.C)((function(e){return e.cards.cardsData.packName})),N=(0,p.C)((function(e){return e.cards.cardsData.packDeckCover})),T=(0,p.C)((function(e){return e.cards.error})),I=(0,g.DU)(),y=(0,r.useState)(!1),O=(0,s.Z)(y,2),D=O[0],A=O[1],B=i()(N,{mimeRequired:!0}),Z=a.cardQuestion?1:0,E=(0,r.useRef)(d||Z||0);d&&!E.current&&E.current++;var P=(0,r.useCallback)((function(){return A(!D)}),[D]),M=(0,r.useCallback)((function(){return I(C.m.LEARN+"/".concat(e))}),[]);return(0,r.useEffect)((function(){"WRONG_ID"===T&&(I(C.m.PAGE_NOT_FOUND,{replace:!0}),n((0,q.sT)({error:null})))}),[T]),(0,r.useEffect)((function(){return n((0,q.az)((0,t.Z)((0,t.Z)({},a),{},{cardsPack_id:e}))),function(){n((0,q.j$)())}}),[]),(0,z.jsx)(z.Fragment,{children:k?(0,z.jsxs)("div",{className:v,children:[(0,z.jsxs)("div",{className:x,children:[(0,z.jsx)(_.C,{linkToPacks:!0,title:k,hasButtons:!!E.current,buttonClick:w?P:M}),B&&(0,z.jsx)("div",{className:j,children:(0,z.jsx)("img",{src:N,alt:"cover",className:b})}),!!E.current&&(0,z.jsx)(u.N,{forCards:!0})]}),(0,z.jsx)(pe,{isMine:w,showButton:!!E.current,handleTitleButton:P}),(0,z.jsx)(c.$,{forCards:!0}),D&&(0,z.jsx)(G,{isOpened:D,onClose:P,cardsPack_id:e||""})]}):(0,z.jsx)(m.A,{})})}}}]);
//# sourceMappingURL=909.fba4faa4.chunk.js.map